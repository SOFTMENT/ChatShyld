{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.211.0"},"children":{"ChatshyldStack":{"id":"ChatshyldStack","path":"ChatshyldStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.211.0"},"children":{"UsersTable":{"id":"UsersTable","path":"ChatshyldStack/UsersTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.211.0","metadata":[{"partitionKey":{"name":"*","type":"S"},"billingMode":"PAY_PER_REQUEST","removalPolicy":"destroy"},{"addGlobalSecondaryIndex":[{"indexName":"*","partitionKey":{"name":"*","type":"S"},"projectionType":"ALL"}]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/UsersTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"userId","attributeType":"S"},{"attributeName":"phone","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"gsi_phone","keySchema":[{"attributeName":"phone","keyType":"HASH"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"userId","keyType":"HASH"}]}}},"ScalingRole":{"id":"ScalingRole","path":"ChatshyldStack/UsersTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}}}},"RefreshTokenTable":{"id":"RefreshTokenTable","path":"ChatshyldStack/RefreshTokenTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.211.0","metadata":[{"partitionKey":{"name":"*","type":"S"},"billingMode":"PAY_PER_REQUEST","removalPolicy":"destroy","timeToLiveAttribute":"*"},{"addGlobalSecondaryIndex":[{"indexName":"*","partitionKey":{"name":"*","type":"S"}}]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/RefreshTokenTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"tokenId","attributeType":"S"},{"attributeName":"userId","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"gsi_user","keySchema":[{"attributeName":"userId","keyType":"HASH"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"tokenId","keyType":"HASH"}],"timeToLiveSpecification":{"attributeName":"ttl","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"ChatshyldStack/RefreshTokenTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}}}},"PhoneDirectoryTable":{"id":"PhoneDirectoryTable","path":"ChatshyldStack/PhoneDirectoryTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.211.0","metadata":[{"partitionKey":{"name":"*","type":"S"},"billingMode":"PAY_PER_REQUEST","removalPolicy":"destroy"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/PhoneDirectoryTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"phone","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"phone","keyType":"HASH"}]}}},"ScalingRole":{"id":"ScalingRole","path":"ChatshyldStack/PhoneDirectoryTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}}}},"AvatarBucket":{"id":"AvatarBucket","path":"ChatshyldStack/AvatarBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.211.0","metadata":[{"removalPolicy":"destroy","autoDeleteObjects":true,"blockPublicAccess":"*","publicReadAccess":false,"cors":[{"allowedMethods":["POST","PUT","GET"],"allowedOrigins":"*","allowedHeaders":"*","exposedHeaders":"*","maxAge":"*"}]},{"addCorsRule":[{"allowedMethods":["POST","PUT","GET"],"allowedOrigins":"*","allowedHeaders":"*","exposedHeaders":"*","maxAge":"*"},"*","*"]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/AvatarBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"corsConfiguration":{"corsRules":[{"maxAge":3000,"allowedHeaders":["*"],"allowedMethods":["POST","PUT","GET"],"allowedOrigins":["*"],"exposedHeaders":["ETag"]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":false,"ignorePublicAcls":true,"restrictPublicBuckets":false},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"ChatshyldStack/AvatarBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.211.0","metadata":[{"bucket":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/AvatarBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"AvatarBucket9BCAEBB3"},"policyDocument":{"Statement":[{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["AvatarBucket9BCAEBB3","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AvatarBucket9BCAEBB3","Arn"]},"/*"]]}]},{"Action":"s3:GetObject","Effect":"Allow","Principal":{"AWS":"*"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["AvatarBucket9BCAEBB3","Arn"]},"/avatars/*"]]}}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"ChatshyldStack/AvatarBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.211.0","metadata":["*"]},"children":{"Default":{"id":"Default","path":"ChatshyldStack/AvatarBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"ChatshyldStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.211.0"},"children":{"Staging":{"id":"Staging","path":"ChatshyldStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"Role":{"id":"Role","path":"ChatshyldStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}},"Handler":{"id":"Handler","path":"ChatshyldStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}},"SendOtpFn":{"id":"SendOtpFn","path":"ChatshyldStack/SendOtpFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*","code":"*"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatshyldStack/SendOtpFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatshyldStack/SendOtpFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatshyldStack/SendOtpFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Code":{"id":"Code","path":"ChatshyldStack/SendOtpFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatshyldStack/SendOtpFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatshyldStack/SendOtpFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/SendOtpFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"6c0013dd6c36d7b117298f12a1010ca1d63102c76d75eecc5b946c251f631540.zip"},"environment":{"variables":{"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"PHONE_GSI":"gsi_phone","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","JWT_TTL_SEC":"7200","TWILIO_ACCOUNT_SID":"AC256b1843957366ea8489ba3b1e27b34e","TWILIO_AUTH_TOKEN":"6cd7cae52a56c472999d3175a95feb98","TWILIO_VERIFY_SID":"VA8e18efe98dfb145f7ce00492939dd7ca","LOG_LEVEL":"INFO","PHONE_DIR_TABLE":{"Ref":"PhoneDirectoryTable4C103417"},"REFRESH_TABLE":{"Ref":"RefreshTokenTable5CB955C2"},"REFRESH_TTL_DAYS":"30","REFRESH_PEPPER":"M8sAw26xTIoXoUJZdWXMbBgH0u9wNosAMxJ66EA0DVXaMGuoMsGg+tAoKZ4bIrFBYZOxRFvcCqbKdtYJpnHftA==","AVATARS_BUCKET":{"Ref":"AvatarBucket9BCAEBB3"},"AVATAR_MAX_BYTES":"2097152"}},"handler":"index.handler","role":{"Fn::GetAtt":["SendOtpFnServiceRoleB9E4E0FE","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatshyldStack/SendOtpFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/SendOtpFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"SendOtpFnA6E032A5"}]]},"retentionInDays":731}}}}}}},"VerifyOtpFn":{"id":"VerifyOtpFn","path":"ChatshyldStack/VerifyOtpFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*","code":"*"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatshyldStack/VerifyOtpFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatshyldStack/VerifyOtpFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatshyldStack/VerifyOtpFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatshyldStack/VerifyOtpFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/VerifyOtpFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["PhoneDirectoryTable4C103417","Arn"]},{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},"/index/*"]]},{"Ref":"AWS::NoValue"}]},{"Action":["dynamodb:BatchWriteItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:PutItem","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["RefreshTokenTable5CB955C2","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["RefreshTokenTable5CB955C2","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"VerifyOtpFnServiceRoleDefaultPolicy2BA549D8","roles":[{"Ref":"VerifyOtpFnServiceRole76089F2F"}]}}}}}}},"Code":{"id":"Code","path":"ChatshyldStack/VerifyOtpFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatshyldStack/VerifyOtpFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatshyldStack/VerifyOtpFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/VerifyOtpFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"a19f31d018c751b5cb91e80de48995f917758476f6642669f50a064403953367.zip"},"environment":{"variables":{"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"PHONE_GSI":"gsi_phone","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","JWT_TTL_SEC":"7200","TWILIO_ACCOUNT_SID":"AC256b1843957366ea8489ba3b1e27b34e","TWILIO_AUTH_TOKEN":"6cd7cae52a56c472999d3175a95feb98","TWILIO_VERIFY_SID":"VA8e18efe98dfb145f7ce00492939dd7ca","LOG_LEVEL":"INFO","PHONE_DIR_TABLE":{"Ref":"PhoneDirectoryTable4C103417"},"REFRESH_TABLE":{"Ref":"RefreshTokenTable5CB955C2"},"REFRESH_TTL_DAYS":"30","REFRESH_PEPPER":"M8sAw26xTIoXoUJZdWXMbBgH0u9wNosAMxJ66EA0DVXaMGuoMsGg+tAoKZ4bIrFBYZOxRFvcCqbKdtYJpnHftA==","AVATARS_BUCKET":{"Ref":"AvatarBucket9BCAEBB3"},"AVATAR_MAX_BYTES":"2097152"}},"handler":"index.handler","role":{"Fn::GetAtt":["VerifyOtpFnServiceRole76089F2F","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatshyldStack/VerifyOtpFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/VerifyOtpFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"VerifyOtpFn7C64DA59"}]]},"retentionInDays":731}}}}}}},"RefreshTokenFn":{"id":"RefreshTokenFn","path":"ChatshyldStack/RefreshTokenFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*","code":"*"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatshyldStack/RefreshTokenFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatshyldStack/RefreshTokenFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatshyldStack/RefreshTokenFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatshyldStack/RefreshTokenFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/RefreshTokenFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["RefreshTokenTable5CB955C2","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["RefreshTokenTable5CB955C2","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"RefreshTokenFnServiceRoleDefaultPolicy8145DA30","roles":[{"Ref":"RefreshTokenFnServiceRole8719035D"}]}}}}}}},"Code":{"id":"Code","path":"ChatshyldStack/RefreshTokenFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatshyldStack/RefreshTokenFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatshyldStack/RefreshTokenFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/RefreshTokenFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"c7cb392502cad2bfaf920f1259c8b59c66616a7527bdb3667e5c2c52b61022b6.zip"},"environment":{"variables":{"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"PHONE_GSI":"gsi_phone","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","JWT_TTL_SEC":"7200","TWILIO_ACCOUNT_SID":"AC256b1843957366ea8489ba3b1e27b34e","TWILIO_AUTH_TOKEN":"6cd7cae52a56c472999d3175a95feb98","TWILIO_VERIFY_SID":"VA8e18efe98dfb145f7ce00492939dd7ca","LOG_LEVEL":"INFO","PHONE_DIR_TABLE":{"Ref":"PhoneDirectoryTable4C103417"},"REFRESH_TABLE":{"Ref":"RefreshTokenTable5CB955C2"},"REFRESH_TTL_DAYS":"30","REFRESH_PEPPER":"M8sAw26xTIoXoUJZdWXMbBgH0u9wNosAMxJ66EA0DVXaMGuoMsGg+tAoKZ4bIrFBYZOxRFvcCqbKdtYJpnHftA==","AVATARS_BUCKET":{"Ref":"AvatarBucket9BCAEBB3"},"AVATAR_MAX_BYTES":"2097152"}},"handler":"index.handler","role":{"Fn::GetAtt":["RefreshTokenFnServiceRole8719035D","Arn"]},"runtime":"nodejs22.x","timeout":5}}},"LogGroup":{"id":"LogGroup","path":"ChatshyldStack/RefreshTokenFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/RefreshTokenFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"RefreshTokenFn26F5D4C4"}]]},"retentionInDays":731}}}}}}},"GetUserFn":{"id":"GetUserFn","path":"ChatshyldStack/GetUserFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*","code":"*"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatshyldStack/GetUserFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatshyldStack/GetUserFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatshyldStack/GetUserFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatshyldStack/GetUserFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/GetUserFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"GetUserFnServiceRoleDefaultPolicyC8125AD0","roles":[{"Ref":"GetUserFnServiceRoleFC2429D1"}]}}}}}}},"Code":{"id":"Code","path":"ChatshyldStack/GetUserFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatshyldStack/GetUserFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatshyldStack/GetUserFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/GetUserFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"13fab471098276e532b31d8310801be1fcb79174458ed38ff77178e91344ede3.zip"},"environment":{"variables":{"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"PHONE_GSI":"gsi_phone","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","JWT_TTL_SEC":"7200","TWILIO_ACCOUNT_SID":"AC256b1843957366ea8489ba3b1e27b34e","TWILIO_AUTH_TOKEN":"6cd7cae52a56c472999d3175a95feb98","TWILIO_VERIFY_SID":"VA8e18efe98dfb145f7ce00492939dd7ca","LOG_LEVEL":"INFO","PHONE_DIR_TABLE":{"Ref":"PhoneDirectoryTable4C103417"},"REFRESH_TABLE":{"Ref":"RefreshTokenTable5CB955C2"},"REFRESH_TTL_DAYS":"30","REFRESH_PEPPER":"M8sAw26xTIoXoUJZdWXMbBgH0u9wNosAMxJ66EA0DVXaMGuoMsGg+tAoKZ4bIrFBYZOxRFvcCqbKdtYJpnHftA==","AVATARS_BUCKET":{"Ref":"AvatarBucket9BCAEBB3"},"AVATAR_MAX_BYTES":"2097152"}},"handler":"index.handler","role":{"Fn::GetAtt":["GetUserFnServiceRoleFC2429D1","Arn"]},"runtime":"nodejs22.x","timeout":5}}},"LogGroup":{"id":"LogGroup","path":"ChatshyldStack/GetUserFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/GetUserFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"GetUserFn2C6EE015"}]]},"retentionInDays":731}}}}}}},"UpdateUserFn":{"id":"UpdateUserFn","path":"ChatshyldStack/UpdateUserFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*","code":"*"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatshyldStack/UpdateUserFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatshyldStack/UpdateUserFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatshyldStack/UpdateUserFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatshyldStack/UpdateUserFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/UpdateUserFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},"/index/*"]]}]},{"Action":"s3:DeleteObject*","Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["AvatarBucket9BCAEBB3","Arn"]},"/*"]]}}],"Version":"2012-10-17"},"policyName":"UpdateUserFnServiceRoleDefaultPolicy43742191","roles":[{"Ref":"UpdateUserFnServiceRole19495F0B"}]}}}}}}},"Code":{"id":"Code","path":"ChatshyldStack/UpdateUserFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatshyldStack/UpdateUserFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatshyldStack/UpdateUserFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/UpdateUserFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"15f569aab3ae7c4a81b36c417ad83622f1961691d1821c000eda53aafe4bd298.zip"},"environment":{"variables":{"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"PHONE_GSI":"gsi_phone","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","JWT_TTL_SEC":"7200","TWILIO_ACCOUNT_SID":"AC256b1843957366ea8489ba3b1e27b34e","TWILIO_AUTH_TOKEN":"6cd7cae52a56c472999d3175a95feb98","TWILIO_VERIFY_SID":"VA8e18efe98dfb145f7ce00492939dd7ca","LOG_LEVEL":"INFO","PHONE_DIR_TABLE":{"Ref":"PhoneDirectoryTable4C103417"},"REFRESH_TABLE":{"Ref":"RefreshTokenTable5CB955C2"},"REFRESH_TTL_DAYS":"30","REFRESH_PEPPER":"M8sAw26xTIoXoUJZdWXMbBgH0u9wNosAMxJ66EA0DVXaMGuoMsGg+tAoKZ4bIrFBYZOxRFvcCqbKdtYJpnHftA==","AVATARS_BUCKET":{"Ref":"AvatarBucket9BCAEBB3"},"AVATAR_MAX_BYTES":"2097152"}},"handler":"index.handler","role":{"Fn::GetAtt":["UpdateUserFnServiceRole19495F0B","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatshyldStack/UpdateUserFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/UpdateUserFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"UpdateUserFn71C6325C"}]]},"retentionInDays":731}}}}}}},"ContactsLookupFn":{"id":"ContactsLookupFn","path":"ChatshyldStack/ContactsLookupFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*","code":"*"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatshyldStack/ContactsLookupFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatshyldStack/ContactsLookupFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatshyldStack/ContactsLookupFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatshyldStack/ContactsLookupFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ContactsLookupFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["PhoneDirectoryTable4C103417","Arn"]},{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},"/index/*"]]},{"Ref":"AWS::NoValue"}]}],"Version":"2012-10-17"},"policyName":"ContactsLookupFnServiceRoleDefaultPolicy1D5A2B0D","roles":[{"Ref":"ContactsLookupFnServiceRole3FB37B9A"}]}}}}}}},"Code":{"id":"Code","path":"ChatshyldStack/ContactsLookupFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatshyldStack/ContactsLookupFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatshyldStack/ContactsLookupFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/ContactsLookupFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"834879ecec3b08195c3f1ad173bd79f731ad9abe77906f83427c206fb243801d.zip"},"environment":{"variables":{"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"PHONE_GSI":"gsi_phone","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","JWT_TTL_SEC":"7200","TWILIO_ACCOUNT_SID":"AC256b1843957366ea8489ba3b1e27b34e","TWILIO_AUTH_TOKEN":"6cd7cae52a56c472999d3175a95feb98","TWILIO_VERIFY_SID":"VA8e18efe98dfb145f7ce00492939dd7ca","LOG_LEVEL":"INFO","PHONE_DIR_TABLE":{"Ref":"PhoneDirectoryTable4C103417"},"REFRESH_TABLE":{"Ref":"RefreshTokenTable5CB955C2"},"REFRESH_TTL_DAYS":"30","REFRESH_PEPPER":"M8sAw26xTIoXoUJZdWXMbBgH0u9wNosAMxJ66EA0DVXaMGuoMsGg+tAoKZ4bIrFBYZOxRFvcCqbKdtYJpnHftA==","AVATARS_BUCKET":{"Ref":"AvatarBucket9BCAEBB3"},"AVATAR_MAX_BYTES":"2097152"}},"handler":"index.handler","role":{"Fn::GetAtt":["ContactsLookupFnServiceRole3FB37B9A","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatshyldStack/ContactsLookupFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ContactsLookupFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"ContactsLookupFn8F3C39D1"}]]},"retentionInDays":731}}}}}}},"PresignAvatarFn":{"id":"PresignAvatarFn","path":"ChatshyldStack/PresignAvatarFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*","code":"*"},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatshyldStack/PresignAvatarFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatshyldStack/PresignAvatarFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatshyldStack/PresignAvatarFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatshyldStack/PresignAvatarFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/PresignAvatarFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:Abort*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["AvatarBucket9BCAEBB3","Arn"]},"/*"]]}}],"Version":"2012-10-17"},"policyName":"PresignAvatarFnServiceRoleDefaultPolicy8ABFE28E","roles":[{"Ref":"PresignAvatarFnServiceRoleD3436466"}]}}}}}}},"Code":{"id":"Code","path":"ChatshyldStack/PresignAvatarFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatshyldStack/PresignAvatarFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatshyldStack/PresignAvatarFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/PresignAvatarFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"63922978743b537588991e8d8df46e1b4a9a87523bb8d5cb4895891e269f69df.zip"},"environment":{"variables":{"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"PHONE_GSI":"gsi_phone","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","JWT_TTL_SEC":"7200","TWILIO_ACCOUNT_SID":"AC256b1843957366ea8489ba3b1e27b34e","TWILIO_AUTH_TOKEN":"6cd7cae52a56c472999d3175a95feb98","TWILIO_VERIFY_SID":"VA8e18efe98dfb145f7ce00492939dd7ca","LOG_LEVEL":"INFO","PHONE_DIR_TABLE":{"Ref":"PhoneDirectoryTable4C103417"},"REFRESH_TABLE":{"Ref":"RefreshTokenTable5CB955C2"},"REFRESH_TTL_DAYS":"30","REFRESH_PEPPER":"M8sAw26xTIoXoUJZdWXMbBgH0u9wNosAMxJ66EA0DVXaMGuoMsGg+tAoKZ4bIrFBYZOxRFvcCqbKdtYJpnHftA==","AVATARS_BUCKET":{"Ref":"AvatarBucket9BCAEBB3"},"AVATAR_MAX_BYTES":"2097152"}},"handler":"index.handler","role":{"Fn::GetAtt":["PresignAvatarFnServiceRoleD3436466","Arn"]},"runtime":"nodejs22.x","timeout":5}}},"LogGroup":{"id":"LogGroup","path":"ChatshyldStack/PresignAvatarFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/PresignAvatarFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"PresignAvatarFnFCD67BCC"}]]},"retentionInDays":731}}}}}}},"ChatShyldHttpApi":{"id":"ChatShyldHttpApi","path":"ChatshyldStack/ChatShyldHttpApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpApi","version":"2.211.0","metadata":["*","*","*","*","*","*","*","*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnApi","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Api","aws:cdk:cloudformation:props":{"corsConfiguration":{"allowHeaders":["*"],"allowMethods":["*"],"allowOrigins":["*"]},"name":"ChatShyldApi","protocolType":"HTTP"}}},"DefaultStage":{"id":"DefaultStage","path":"ChatshyldStack/ChatShyldHttpApi/DefaultStage","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpStage","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/DefaultStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"autoDeploy":true,"stageName":"$default"}}}}},"POST--auth--send-otp":{"id":"POST--auth--send-otp","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--send-otp","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.211.0","metadata":["*"]},"children":{"SendOtpIntegration":{"id":"SendOtpIntegration","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--send-otp/SendOtpIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--send-otp/SendOtpIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["SendOtpFnA6E032A5","Arn"]},"payloadFormatVersion":"2.0"}}}}},"SendOtpIntegration-Permission":{"id":"SendOtpIntegration-Permission","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--send-otp/SendOtpIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["SendOtpFnA6E032A5","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatShyldHttpApiE87B938B"},"/*/*/auth/send-otp"]]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--send-otp/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"authorizationType":"NONE","routeKey":"POST /auth/send-otp","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatShyldHttpApiPOSTauthsendotpSendOtpIntegration5796B4DF"}]]}}}}}},"POST--auth--verify-otp":{"id":"POST--auth--verify-otp","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--verify-otp","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.211.0","metadata":["*"]},"children":{"VerifyOtpIntegration":{"id":"VerifyOtpIntegration","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--verify-otp/VerifyOtpIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--verify-otp/VerifyOtpIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["VerifyOtpFn7C64DA59","Arn"]},"payloadFormatVersion":"2.0"}}}}},"VerifyOtpIntegration-Permission":{"id":"VerifyOtpIntegration-Permission","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--verify-otp/VerifyOtpIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["VerifyOtpFn7C64DA59","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatShyldHttpApiE87B938B"},"/*/*/auth/verify-otp"]]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--verify-otp/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"authorizationType":"NONE","routeKey":"POST /auth/verify-otp","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatShyldHttpApiPOSTauthverifyotpVerifyOtpIntegration8BBC8DD9"}]]}}}}}},"POST--auth--refresh":{"id":"POST--auth--refresh","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--refresh","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.211.0","metadata":["*"]},"children":{"RefreshTokenIntegration":{"id":"RefreshTokenIntegration","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--refresh/RefreshTokenIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--refresh/RefreshTokenIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["RefreshTokenFn26F5D4C4","Arn"]},"payloadFormatVersion":"2.0"}}}}},"RefreshTokenIntegration-Permission":{"id":"RefreshTokenIntegration-Permission","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--refresh/RefreshTokenIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["RefreshTokenFn26F5D4C4","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatShyldHttpApiE87B938B"},"/*/*/auth/refresh"]]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--refresh/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"authorizationType":"NONE","routeKey":"POST /auth/refresh","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatShyldHttpApiPOSTauthrefreshRefreshTokenIntegration910872C9"}]]}}}}}},"GET--profile--me":{"id":"GET--profile--me","path":"ChatshyldStack/ChatShyldHttpApi/GET--profile--me","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.211.0","metadata":["*"]},"children":{"GetUserIntegration":{"id":"GetUserIntegration","path":"ChatshyldStack/ChatShyldHttpApi/GET--profile--me/GetUserIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/GET--profile--me/GetUserIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["GetUserFn2C6EE015","Arn"]},"payloadFormatVersion":"2.0"}}}}},"GetUserIntegration-Permission":{"id":"GetUserIntegration-Permission","path":"ChatshyldStack/ChatShyldHttpApi/GET--profile--me/GetUserIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["GetUserFn2C6EE015","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatShyldHttpApiE87B938B"},"/*/*/profile/me"]]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/GET--profile--me/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"authorizationType":"NONE","routeKey":"GET /profile/me","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatShyldHttpApiGETprofilemeGetUserIntegration6913437D"}]]}}}}}},"PATCH--profile--me":{"id":"PATCH--profile--me","path":"ChatshyldStack/ChatShyldHttpApi/PATCH--profile--me","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.211.0","metadata":["*"]},"children":{"UpdateUserIntegration":{"id":"UpdateUserIntegration","path":"ChatshyldStack/ChatShyldHttpApi/PATCH--profile--me/UpdateUserIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/PATCH--profile--me/UpdateUserIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["UpdateUserFn71C6325C","Arn"]},"payloadFormatVersion":"2.0"}}}}},"UpdateUserIntegration-Permission":{"id":"UpdateUserIntegration-Permission","path":"ChatshyldStack/ChatShyldHttpApi/PATCH--profile--me/UpdateUserIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["UpdateUserFn71C6325C","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatShyldHttpApiE87B938B"},"/*/*/profile/me"]]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/PATCH--profile--me/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"authorizationType":"NONE","routeKey":"PATCH /profile/me","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatShyldHttpApiPATCHprofilemeUpdateUserIntegration4CF6FBF6"}]]}}}}}},"POST--contacts--lookup":{"id":"POST--contacts--lookup","path":"ChatshyldStack/ChatShyldHttpApi/POST--contacts--lookup","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.211.0","metadata":["*"]},"children":{"ContactsLookupIntegration":{"id":"ContactsLookupIntegration","path":"ChatshyldStack/ChatShyldHttpApi/POST--contacts--lookup/ContactsLookupIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--contacts--lookup/ContactsLookupIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["ContactsLookupFn8F3C39D1","Arn"]},"payloadFormatVersion":"2.0"}}}}},"ContactsLookupIntegration-Permission":{"id":"ContactsLookupIntegration-Permission","path":"ChatshyldStack/ChatShyldHttpApi/POST--contacts--lookup/ContactsLookupIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["ContactsLookupFn8F3C39D1","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatShyldHttpApiE87B938B"},"/*/*/contacts/lookup"]]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--contacts--lookup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"authorizationType":"NONE","routeKey":"POST /contacts/lookup","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatShyldHttpApiPOSTcontactslookupContactsLookupIntegrationE9271B3C"}]]}}}}}},"POST--profile--avatar--presign":{"id":"POST--profile--avatar--presign","path":"ChatshyldStack/ChatShyldHttpApi/POST--profile--avatar--presign","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.211.0","metadata":["*"]},"children":{"PresignAvatarIntegration":{"id":"PresignAvatarIntegration","path":"ChatshyldStack/ChatShyldHttpApi/POST--profile--avatar--presign/PresignAvatarIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--profile--avatar--presign/PresignAvatarIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["PresignAvatarFnFCD67BCC","Arn"]},"payloadFormatVersion":"2.0"}}}}},"PresignAvatarIntegration-Permission":{"id":"PresignAvatarIntegration-Permission","path":"ChatshyldStack/ChatShyldHttpApi/POST--profile--avatar--presign/PresignAvatarIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["PresignAvatarFnFCD67BCC","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatShyldHttpApiE87B938B"},"/*/*/profile/avatar/presign"]]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--profile--avatar--presign/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"authorizationType":"NONE","routeKey":"POST /profile/avatar/presign","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatShyldHttpApiPOSTprofileavatarpresignPresignAvatarIntegration001E4C47"}]]}}}}}}}},"ProdStage":{"id":"ProdStage","path":"ChatshyldStack/ProdStage","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpStage","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ProdStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"autoDeploy":true,"defaultRouteSettings":{"throttlingBurstLimit":50,"throttlingRateLimit":30},"stageName":"prod"}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"ChatshyldStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ChatshyldStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ChatshyldStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.211.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ChatshyldStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.211.0"}}}},"ChatRealtimeStack":{"id":"ChatRealtimeStack","path":"ChatRealtimeStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.211.0"},"children":{"ChatAttachments":{"id":"ChatAttachments","path":"ChatRealtimeStack/ChatAttachments","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.211.0","metadata":[{"blockPublicAccess":"*","removalPolicy":"destroy","autoDeleteObjects":true,"cors":[{"allowedOrigins":"*","allowedMethods":["POST","PUT","GET","HEAD"],"allowedHeaders":"*","maxAge":"*"}]},{"addCorsRule":[{"allowedOrigins":"*","allowedMethods":["POST","PUT","GET","HEAD"],"allowedHeaders":"*","maxAge":"*"},"*","*"]}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatAttachments/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"corsConfiguration":{"corsRules":[{"maxAge":3600,"allowedHeaders":["*"],"allowedMethods":["POST","PUT","GET","HEAD"],"allowedOrigins":["*"]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"ChatRealtimeStack/ChatAttachments/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.211.0","metadata":[{"bucket":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatAttachments/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"ChatAttachments15D39CA3"},"policyDocument":{"Statement":[{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["ChatAttachments15D39CA3","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ChatAttachments15D39CA3","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"ChatRealtimeStack/ChatAttachments/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.211.0","metadata":["*"]},"children":{"Default":{"id":"Default","path":"ChatRealtimeStack/ChatAttachments/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"ChatRealtimeStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.211.0"},"children":{"Staging":{"id":"Staging","path":"ChatRealtimeStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"Role":{"id":"Role","path":"ChatRealtimeStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}},"Handler":{"id":"Handler","path":"ChatRealtimeStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}},"ConnectionsTable":{"id":"ConnectionsTable","path":"ChatRealtimeStack/ConnectionsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.211.0","metadata":[{"partitionKey":{"name":"*","type":"S"},"billingMode":"PAY_PER_REQUEST","timeToLiveAttribute":"*","removalPolicy":"destroy"},{"addGlobalSecondaryIndex":[{"indexName":"*","partitionKey":{"name":"*","type":"S"},"projectionType":"ALL"}]}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ConnectionsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"connectionId","attributeType":"S"},{"attributeName":"userId","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"gsi_user","keySchema":[{"attributeName":"userId","keyType":"HASH"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"connectionId","keyType":"HASH"}],"timeToLiveSpecification":{"attributeName":"ttl","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"ChatRealtimeStack/ConnectionsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}}}},"ConversationsTable":{"id":"ConversationsTable","path":"ChatRealtimeStack/ConversationsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.211.0","metadata":[{"partitionKey":{"name":"*","type":"S"},"billingMode":"PAY_PER_REQUEST","removalPolicy":"destroy"}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ConversationsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"convoId","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"convoId","keyType":"HASH"}]}}},"ScalingRole":{"id":"ScalingRole","path":"ChatRealtimeStack/ConversationsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}}}},"MessagesTable":{"id":"MessagesTable","path":"ChatRealtimeStack/MessagesTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.211.0","metadata":[{"partitionKey":{"name":"*","type":"S"},"sortKey":{"name":"*","type":"S"},"billingMode":"PAY_PER_REQUEST","removalPolicy":"destroy"},{"addGlobalSecondaryIndex":[{"indexName":"*","partitionKey":{"name":"*","type":"S"}}]}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/MessagesTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"convoId","attributeType":"S"},{"attributeName":"messageId","attributeType":"S"},{"attributeName":"toUser","attributeType":"S"},{"attributeName":"createdAt","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"gsi_user_time","keySchema":[{"attributeName":"toUser","keyType":"HASH"},{"attributeName":"createdAt","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"convoId","keyType":"HASH"},{"attributeName":"messageId","keyType":"RANGE"}]}}},"ScalingRole":{"id":"ScalingRole","path":"ChatRealtimeStack/MessagesTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}}}},"WsConnectFn":{"id":"WsConnectFn","path":"ChatRealtimeStack/WsConnectFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*","code":"*"},{},{},{},{},{},{},{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatRealtimeStack/WsConnectFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatRealtimeStack/WsConnectFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsConnectFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatRealtimeStack/WsConnectFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsConnectFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ConnectionsTable8000B8A1","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ConnectionsTable8000B8A1","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"WsConnectFnServiceRoleDefaultPolicyE8538EDC","roles":[{"Ref":"WsConnectFnServiceRole749353A4"}]}}}}}}},"Code":{"id":"Code","path":"ChatRealtimeStack/WsConnectFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatRealtimeStack/WsConnectFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatRealtimeStack/WsConnectFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsConnectFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"2123e0109a45b89a6a30329003ebee13f351457d2e289000d4b8234f54acdc0d.zip"},"environment":{"variables":{"USERS_TABLE":"","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","ATTACH_BUCKET":{"Ref":"ChatAttachments15D39CA3"},"CONN_TABLE":{"Ref":"ConnectionsTable8000B8A1"},"MSG_TABLE":{"Ref":"MessagesTable05B58A27"},"CONVO_TABLE":{"Ref":"ConversationsTableCD91EB96"}}},"handler":"index.handler","role":{"Fn::GetAtt":["WsConnectFnServiceRole749353A4","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatRealtimeStack/WsConnectFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsConnectFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"WsConnectFnB17D99F3"}]]},"retentionInDays":731}}}}}}},"WsDisconnectFn":{"id":"WsDisconnectFn","path":"ChatRealtimeStack/WsDisconnectFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*","code":"*"},{},{},{},{},{},{},{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatRealtimeStack/WsDisconnectFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatRealtimeStack/WsDisconnectFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsDisconnectFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatRealtimeStack/WsDisconnectFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsDisconnectFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ConnectionsTable8000B8A1","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ConnectionsTable8000B8A1","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"WsDisconnectFnServiceRoleDefaultPolicy76179A14","roles":[{"Ref":"WsDisconnectFnServiceRoleF36033AD"}]}}}}}}},"Code":{"id":"Code","path":"ChatRealtimeStack/WsDisconnectFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatRealtimeStack/WsDisconnectFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatRealtimeStack/WsDisconnectFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsDisconnectFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"3b50f48a91d6403354a53033984c41f7a223e71c7755d2f4a4f4e1a618321bd1.zip"},"environment":{"variables":{"USERS_TABLE":"","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","ATTACH_BUCKET":{"Ref":"ChatAttachments15D39CA3"},"CONN_TABLE":{"Ref":"ConnectionsTable8000B8A1"},"MSG_TABLE":{"Ref":"MessagesTable05B58A27"},"CONVO_TABLE":{"Ref":"ConversationsTableCD91EB96"}}},"handler":"index.handler","role":{"Fn::GetAtt":["WsDisconnectFnServiceRoleF36033AD","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatRealtimeStack/WsDisconnectFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsDisconnectFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"WsDisconnectFn9523C1B1"}]]},"retentionInDays":731}}}}}}},"WsSendMessageFn":{"id":"WsSendMessageFn","path":"ChatRealtimeStack/WsSendMessageFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*","code":"*"},{},{},{},{},{},{},{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatRealtimeStack/WsSendMessageFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatRealtimeStack/WsSendMessageFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsSendMessageFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatRealtimeStack/WsSendMessageFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsSendMessageFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetBucket*","s3:GetObject*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ChatAttachments15D39CA3","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ChatAttachments15D39CA3","Arn"]},"/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ConnectionsTable8000B8A1","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ConnectionsTable8000B8A1","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ConversationsTableCD91EB96","Arn"]},{"Fn::GetAtt":["MessagesTable05B58A27","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["MessagesTable05B58A27","Arn"]},"/index/*"]]},{"Ref":"AWS::NoValue"}]},{"Action":"execute-api:ManageConnections","Effect":"Allow","Resource":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatWsApiD9A8005F"},"/prod/POST/@connections/*"]]}}],"Version":"2012-10-17"},"policyName":"WsSendMessageFnServiceRoleDefaultPolicy11820FA4","roles":[{"Ref":"WsSendMessageFnServiceRole402D7D23"}]}}}}}}},"Code":{"id":"Code","path":"ChatRealtimeStack/WsSendMessageFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatRealtimeStack/WsSendMessageFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatRealtimeStack/WsSendMessageFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsSendMessageFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"80ad33254932e63fca9835340bbde1f64494b8b5d1dccbb4f07e2985e38df219.zip"},"environment":{"variables":{"USERS_TABLE":"","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","ATTACH_BUCKET":{"Ref":"ChatAttachments15D39CA3"},"CONN_TABLE":{"Ref":"ConnectionsTable8000B8A1"},"MSG_TABLE":{"Ref":"MessagesTable05B58A27"},"CONVO_TABLE":{"Ref":"ConversationsTableCD91EB96"}}},"handler":"index.handler","role":{"Fn::GetAtt":["WsSendMessageFnServiceRole402D7D23","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatRealtimeStack/WsSendMessageFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsSendMessageFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"WsSendMessageFn00921F75"}]]},"retentionInDays":731}}}}}}},"WsTypingFn":{"id":"WsTypingFn","path":"ChatRealtimeStack/WsTypingFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*","code":"*"},{},{},{},{},{},{},{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatRealtimeStack/WsTypingFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatRealtimeStack/WsTypingFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsTypingFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatRealtimeStack/WsTypingFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsTypingFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ConnectionsTable8000B8A1","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ConnectionsTable8000B8A1","Arn"]},"/index/*"]]}]},{"Action":"execute-api:ManageConnections","Effect":"Allow","Resource":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatWsApiD9A8005F"},"/prod/POST/@connections/*"]]}}],"Version":"2012-10-17"},"policyName":"WsTypingFnServiceRoleDefaultPolicy05A11562","roles":[{"Ref":"WsTypingFnServiceRoleE1613406"}]}}}}}}},"Code":{"id":"Code","path":"ChatRealtimeStack/WsTypingFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatRealtimeStack/WsTypingFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatRealtimeStack/WsTypingFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsTypingFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"762a338c888c7a1d6ad3cec83e7d4edf351ac2140e38ffedd08909d0b8adab0a.zip"},"environment":{"variables":{"USERS_TABLE":"","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","ATTACH_BUCKET":{"Ref":"ChatAttachments15D39CA3"},"CONN_TABLE":{"Ref":"ConnectionsTable8000B8A1"},"MSG_TABLE":{"Ref":"MessagesTable05B58A27"},"CONVO_TABLE":{"Ref":"ConversationsTableCD91EB96"}}},"handler":"index.handler","role":{"Fn::GetAtt":["WsTypingFnServiceRoleE1613406","Arn"]},"runtime":"nodejs22.x","timeout":5}}},"LogGroup":{"id":"LogGroup","path":"ChatRealtimeStack/WsTypingFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsTypingFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"WsTypingFn98C24009"}]]},"retentionInDays":731}}}}}}},"WsPingFn":{"id":"WsPingFn","path":"ChatRealtimeStack/WsPingFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*","code":"*"},{},{},{},{},{},{},{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatRealtimeStack/WsPingFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatRealtimeStack/WsPingFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsPingFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatRealtimeStack/WsPingFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsPingFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ConnectionsTable8000B8A1","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ConnectionsTable8000B8A1","Arn"]},"/index/*"]]}]},{"Action":"execute-api:ManageConnections","Effect":"Allow","Resource":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatWsApiD9A8005F"},"/prod/POST/@connections/*"]]}}],"Version":"2012-10-17"},"policyName":"WsPingFnServiceRoleDefaultPolicyBC5A4E69","roles":[{"Ref":"WsPingFnServiceRoleE83E9A18"}]}}}}}}},"Code":{"id":"Code","path":"ChatRealtimeStack/WsPingFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatRealtimeStack/WsPingFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatRealtimeStack/WsPingFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsPingFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"12abe05c4ca0bbd3aadecc3278ddaf5faee32790cd0749bf6173b8a29ec9850f.zip"},"environment":{"variables":{"USERS_TABLE":"","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","ATTACH_BUCKET":{"Ref":"ChatAttachments15D39CA3"},"CONN_TABLE":{"Ref":"ConnectionsTable8000B8A1"},"MSG_TABLE":{"Ref":"MessagesTable05B58A27"},"CONVO_TABLE":{"Ref":"ConversationsTableCD91EB96"}}},"handler":"index.handler","role":{"Fn::GetAtt":["WsPingFnServiceRoleE83E9A18","Arn"]},"runtime":"nodejs22.x","timeout":5}}},"LogGroup":{"id":"LogGroup","path":"ChatRealtimeStack/WsPingFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsPingFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"WsPingFnC535B5AD"}]]},"retentionInDays":731}}}}}}},"InitUploadFn":{"id":"InitUploadFn","path":"ChatRealtimeStack/InitUploadFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*","code":"*"},{},{},{},{},{},{},{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatRealtimeStack/InitUploadFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatRealtimeStack/InitUploadFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/InitUploadFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatRealtimeStack/InitUploadFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/InitUploadFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:Abort*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["ChatAttachments15D39CA3","Arn"]},"/*"]]}}],"Version":"2012-10-17"},"policyName":"InitUploadFnServiceRoleDefaultPolicy83BD6657","roles":[{"Ref":"InitUploadFnServiceRole541A3B75"}]}}}}}}},"Code":{"id":"Code","path":"ChatRealtimeStack/InitUploadFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatRealtimeStack/InitUploadFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatRealtimeStack/InitUploadFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/InitUploadFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"64fa60c230848f601d6863231e7f2b3b2e1ab0f70e4c01dd0961104ed7bd3122.zip"},"environment":{"variables":{"USERS_TABLE":"","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","ATTACH_BUCKET":{"Ref":"ChatAttachments15D39CA3"},"CONN_TABLE":{"Ref":"ConnectionsTable8000B8A1"},"MSG_TABLE":{"Ref":"MessagesTable05B58A27"},"CONVO_TABLE":{"Ref":"ConversationsTableCD91EB96"}}},"handler":"index.handler","role":{"Fn::GetAtt":["InitUploadFnServiceRole541A3B75","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatRealtimeStack/InitUploadFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/InitUploadFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"InitUploadFn6D79C87D"}]]},"retentionInDays":731}}}}}}},"WsDefaultFn":{"id":"WsDefaultFn","path":"ChatRealtimeStack/WsDefaultFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*","code":"*"},{},{},{},{},{},{},{"runtime":"*","timeout":"*","bundling":{"minify":true,"sourcesContent":false},"environment":"*","entry":"*","handler":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatRealtimeStack/WsDefaultFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatRealtimeStack/WsDefaultFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsDefaultFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Code":{"id":"Code","path":"ChatRealtimeStack/WsDefaultFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatRealtimeStack/WsDefaultFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatRealtimeStack/WsDefaultFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsDefaultFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-723609008675-ap-southeast-2","s3Key":"2d3fcad1f8b229ee71d10bd75bcb148c756cc20ad0b5fddf212701361c8fe275.zip"},"environment":{"variables":{"USERS_TABLE":"","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","ATTACH_BUCKET":{"Ref":"ChatAttachments15D39CA3"},"CONN_TABLE":{"Ref":"ConnectionsTable8000B8A1"},"MSG_TABLE":{"Ref":"MessagesTable05B58A27"},"CONVO_TABLE":{"Ref":"ConversationsTableCD91EB96"}}},"handler":"index.handler","role":{"Fn::GetAtt":["WsDefaultFnServiceRole423383DA","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatRealtimeStack/WsDefaultFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/WsDefaultFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"WsDefaultFn14DA6159"}]]},"retentionInDays":731}}}}}}},"ChatWsApi":{"id":"ChatWsApi","path":"ChatRealtimeStack/ChatWsApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketApi","version":"2.211.0","metadata":["*","*","*","*","*","*","*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnApi","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Api","aws:cdk:cloudformation:props":{"name":"ChatWsApi","protocolType":"WEBSOCKET","routeSelectionExpression":"$request.body.action"}}},"$connect-Route":{"id":"$connect-Route","path":"ChatRealtimeStack/ChatWsApi/$connect-Route","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketRoute","version":"2.211.0","metadata":["*"]},"children":{"ConnectInt-Permission":{"id":"ConnectInt-Permission","path":"ChatRealtimeStack/ChatWsApi/$connect-Route/ConnectInt-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["WsConnectFnB17D99F3","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatWsApiD9A8005F"},"/*$connect"]]}}}},"ConnectInt":{"id":"ConnectInt","path":"ChatRealtimeStack/ChatWsApi/$connect-Route/ConnectInt","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/$connect-Route/ConnectInt/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::Join":["",["arn:aws:apigateway:ap-southeast-2:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["WsConnectFnB17D99F3","Arn"]},"/invocations"]]}}}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/$connect-Route/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"authorizationType":"NONE","routeKey":"$connect","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatWsApiconnectRouteConnectIntED4D0871"}]]}}}}}},"$disconnect-Route":{"id":"$disconnect-Route","path":"ChatRealtimeStack/ChatWsApi/$disconnect-Route","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketRoute","version":"2.211.0","metadata":["*"]},"children":{"DisconnectInt-Permission":{"id":"DisconnectInt-Permission","path":"ChatRealtimeStack/ChatWsApi/$disconnect-Route/DisconnectInt-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["WsDisconnectFn9523C1B1","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatWsApiD9A8005F"},"/*$disconnect"]]}}}},"DisconnectInt":{"id":"DisconnectInt","path":"ChatRealtimeStack/ChatWsApi/$disconnect-Route/DisconnectInt","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/$disconnect-Route/DisconnectInt/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::Join":["",["arn:aws:apigateway:ap-southeast-2:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["WsDisconnectFn9523C1B1","Arn"]},"/invocations"]]}}}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/$disconnect-Route/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"authorizationType":"NONE","routeKey":"$disconnect","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatWsApidisconnectRouteDisconnectInt8A2058B9"}]]}}}}}},"sendMessage-Route":{"id":"sendMessage-Route","path":"ChatRealtimeStack/ChatWsApi/sendMessage-Route","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketRoute","version":"2.211.0","metadata":["*"]},"children":{"MsgInt-Permission":{"id":"MsgInt-Permission","path":"ChatRealtimeStack/ChatWsApi/sendMessage-Route/MsgInt-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["WsSendMessageFn00921F75","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatWsApiD9A8005F"},"/*sendMessage"]]}}}},"MsgInt":{"id":"MsgInt","path":"ChatRealtimeStack/ChatWsApi/sendMessage-Route/MsgInt","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/sendMessage-Route/MsgInt/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::Join":["",["arn:aws:apigateway:ap-southeast-2:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["WsSendMessageFn00921F75","Arn"]},"/invocations"]]}}}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/sendMessage-Route/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"authorizationType":"NONE","routeKey":"sendMessage","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatWsApisendMessageRouteMsgInt1D01750C"}]]}}}}}},"typing-Route":{"id":"typing-Route","path":"ChatRealtimeStack/ChatWsApi/typing-Route","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketRoute","version":"2.211.0","metadata":["*"]},"children":{"TypingInt-Permission":{"id":"TypingInt-Permission","path":"ChatRealtimeStack/ChatWsApi/typing-Route/TypingInt-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["WsTypingFn98C24009","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatWsApiD9A8005F"},"/*typing"]]}}}},"TypingInt":{"id":"TypingInt","path":"ChatRealtimeStack/ChatWsApi/typing-Route/TypingInt","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/typing-Route/TypingInt/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::Join":["",["arn:aws:apigateway:ap-southeast-2:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["WsTypingFn98C24009","Arn"]},"/invocations"]]}}}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/typing-Route/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"authorizationType":"NONE","routeKey":"typing","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatWsApitypingRouteTypingInt740748DA"}]]}}}}}},"ping-Route":{"id":"ping-Route","path":"ChatRealtimeStack/ChatWsApi/ping-Route","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketRoute","version":"2.211.0","metadata":["*"]},"children":{"PingInt-Permission":{"id":"PingInt-Permission","path":"ChatRealtimeStack/ChatWsApi/ping-Route/PingInt-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["WsPingFnC535B5AD","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatWsApiD9A8005F"},"/*ping"]]}}}},"PingInt":{"id":"PingInt","path":"ChatRealtimeStack/ChatWsApi/ping-Route/PingInt","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/ping-Route/PingInt/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::Join":["",["arn:aws:apigateway:ap-southeast-2:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["WsPingFnC535B5AD","Arn"]},"/invocations"]]}}}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/ping-Route/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"authorizationType":"NONE","routeKey":"ping","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatWsApipingRoutePingInt09F2D6D4"}]]}}}}}},"$default-Route":{"id":"$default-Route","path":"ChatRealtimeStack/ChatWsApi/$default-Route","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketRoute","version":"2.211.0","metadata":["*"]},"children":{"DefaultInt-Permission":{"id":"DefaultInt-Permission","path":"ChatRealtimeStack/ChatWsApi/$default-Route/DefaultInt-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["WsDefaultFn14DA6159","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatWsApiD9A8005F"},"/*$default"]]}}}},"DefaultInt":{"id":"DefaultInt","path":"ChatRealtimeStack/ChatWsApi/$default-Route/DefaultInt","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/$default-Route/DefaultInt/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::Join":["",["arn:aws:apigateway:ap-southeast-2:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["WsDefaultFn14DA6159","Arn"]},"/invocations"]]}}}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatWsApi/$default-Route/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"authorizationType":"NONE","routeKey":"$default","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatWsApidefaultRouteDefaultInt3C53A290"}]]}}}}}}}},"ProdWsStage":{"id":"ProdWsStage","path":"ChatRealtimeStack/ProdWsStage","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.WebSocketStage","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ProdWsStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatWsApiD9A8005F"},"autoDeploy":true,"stageName":"prod"}}}}},"ChatHttp":{"id":"ChatHttp","path":"ChatRealtimeStack/ChatHttp","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpApi","version":"2.211.0","metadata":["*","*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatHttp/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnApi","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Api","aws:cdk:cloudformation:props":{"corsConfiguration":{"allowHeaders":["*"],"allowMethods":["POST","OPTIONS"],"allowOrigins":["*"]},"name":"ChatHttp","protocolType":"HTTP"}}},"DefaultStage":{"id":"DefaultStage","path":"ChatRealtimeStack/ChatHttp/DefaultStage","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpStage","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatHttp/DefaultStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatHttpA0B2C03F"},"autoDeploy":true,"stageName":"$default"}}}}},"POST--attachments--init-upload":{"id":"POST--attachments--init-upload","path":"ChatRealtimeStack/ChatHttp/POST--attachments--init-upload","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.211.0","metadata":["*"]},"children":{"InitUploadInt":{"id":"InitUploadInt","path":"ChatRealtimeStack/ChatHttp/POST--attachments--init-upload/InitUploadInt","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatHttp/POST--attachments--init-upload/InitUploadInt/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatHttpA0B2C03F"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["InitUploadFn6D79C87D","Arn"]},"payloadFormatVersion":"2.0"}}}}},"InitUploadInt-Permission":{"id":"InitUploadInt-Permission","path":"ChatRealtimeStack/ChatHttp/POST--attachments--init-upload/InitUploadInt-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["InitUploadFn6D79C87D","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:ap-southeast-2:723609008675:",{"Ref":"ChatHttpA0B2C03F"},"/*/*/attachments/init-upload"]]}}}},"Resource":{"id":"Resource","path":"ChatRealtimeStack/ChatHttp/POST--attachments--init-upload/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatHttpA0B2C03F"},"authorizationType":"NONE","routeKey":"POST /attachments/init-upload","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatHttpPOSTattachmentsinituploadInitUploadInt97D75032"}]]}}}}}}}},"WsUrl":{"id":"WsUrl","path":"ChatRealtimeStack/WsUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.211.0"}},"HttpUrl":{"id":"HttpUrl","path":"ChatRealtimeStack/HttpUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.211.0"}},"AttachmentsBucket":{"id":"AttachmentsBucket","path":"ChatRealtimeStack/AttachmentsBucket","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.211.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"ChatRealtimeStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ChatRealtimeStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ChatRealtimeStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.211.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ChatRealtimeStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.211.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}