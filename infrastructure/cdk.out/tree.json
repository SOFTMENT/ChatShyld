{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.211.0"},"children":{"ChatshyldStack":{"id":"ChatshyldStack","path":"ChatshyldStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.211.0"},"children":{"UsersTable":{"id":"UsersTable","path":"ChatshyldStack/UsersTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.211.0","metadata":[{"partitionKey":{"name":"*","type":"S"},"billingMode":"PAY_PER_REQUEST","removalPolicy":"destroy"},{"addGlobalSecondaryIndex":[{"indexName":"*","partitionKey":{"name":"*","type":"S"},"projectionType":"ALL"}]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/UsersTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"userId","attributeType":"S"},{"attributeName":"phone","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"gsi_phone","keySchema":[{"attributeName":"phone","keyType":"HASH"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"userId","keyType":"HASH"}]}}},"ScalingRole":{"id":"ScalingRole","path":"ChatshyldStack/UsersTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}}}},"SendOtpFn":{"id":"SendOtpFn","path":"ChatshyldStack/SendOtpFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*","code":"*"},{},{},{},{},{},{},{},{},{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatshyldStack/SendOtpFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatshyldStack/SendOtpFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatshyldStack/SendOtpFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Code":{"id":"Code","path":"ChatshyldStack/SendOtpFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatshyldStack/SendOtpFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatshyldStack/SendOtpFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/SendOtpFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-723609008675-${AWS::Region}"},"s3Key":"dc8ce87bf34bd5b29389a0602c4e58498246c699d4b64e97b4103cd218dff9c7.zip"},"environment":{"variables":{"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"PHONE_GSI":"gsi_phone","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","JWT_TTL_SEC":"7200","TWILIO_ACCOUNT_SID":"AC256b1843957366ea8489ba3b1e27b34e","TWILIO_AUTH_TOKEN":"6cd7cae52a56c472999d3175a95feb98","TWILIO_VERIFY_SID":"VA8e18efe98dfb145f7ce00492939dd7ca","LOG_LEVEL":"INFO"}},"handler":"index.handler","role":{"Fn::GetAtt":["SendOtpFnServiceRoleB9E4E0FE","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatshyldStack/SendOtpFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/SendOtpFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"SendOtpFnA6E032A5"}]]},"retentionInDays":731}}}}}}},"VerifyOtpFn":{"id":"VerifyOtpFn","path":"ChatshyldStack/VerifyOtpFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*","code":"*"},{},{},{},{},{},{},{},{},{"runtime":"*","entry":"*","handler":"*","timeout":"*","environment":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ChatshyldStack/VerifyOtpFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ChatshyldStack/VerifyOtpFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ChatshyldStack/VerifyOtpFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ChatshyldStack/VerifyOtpFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/VerifyOtpFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"VerifyOtpFnServiceRoleDefaultPolicy2BA549D8","roles":[{"Ref":"VerifyOtpFnServiceRole76089F2F"}]}}}}}}},"Code":{"id":"Code","path":"ChatshyldStack/VerifyOtpFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"ChatshyldStack/VerifyOtpFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"ChatshyldStack/VerifyOtpFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/VerifyOtpFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-723609008675-${AWS::Region}"},"s3Key":"97f815716d9bf54a8948c9f515c34238ee9ad99839574c2ec514cdc385a4c784.zip"},"environment":{"variables":{"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"PHONE_GSI":"gsi_phone","JWT_SECRET":"0c58fe6a71c3663728494eeb159cdf53c3b2098e26f34e67696313a8ce169df7c15d7f7f","JWT_TTL_SEC":"7200","TWILIO_ACCOUNT_SID":"AC256b1843957366ea8489ba3b1e27b34e","TWILIO_AUTH_TOKEN":"6cd7cae52a56c472999d3175a95feb98","TWILIO_VERIFY_SID":"VA8e18efe98dfb145f7ce00492939dd7ca","LOG_LEVEL":"INFO"}},"handler":"index.handler","role":{"Fn::GetAtt":["VerifyOtpFnServiceRole76089F2F","Arn"]},"runtime":"nodejs22.x","timeout":10}}},"LogGroup":{"id":"LogGroup","path":"ChatshyldStack/VerifyOtpFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.211.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/VerifyOtpFn/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"VerifyOtpFn7C64DA59"}]]},"retentionInDays":731}}}}}}},"ChatShyldHttpApi":{"id":"ChatShyldHttpApi","path":"ChatshyldStack/ChatShyldHttpApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpApi","version":"2.211.0","metadata":["*","*","*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnApi","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Api","aws:cdk:cloudformation:props":{"corsConfiguration":{"allowHeaders":["*"],"allowMethods":["*"],"allowOrigins":["*"]},"name":"ChatShyldApi","protocolType":"HTTP"}}},"DefaultStage":{"id":"DefaultStage","path":"ChatshyldStack/ChatShyldHttpApi/DefaultStage","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpStage","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/DefaultStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"autoDeploy":true,"stageName":"$default"}}}}},"POST--auth--send-otp":{"id":"POST--auth--send-otp","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--send-otp","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.211.0","metadata":["*"]},"children":{"SendOtpIntegration":{"id":"SendOtpIntegration","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--send-otp/SendOtpIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--send-otp/SendOtpIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["SendOtpFnA6E032A5","Arn"]},"payloadFormatVersion":"2.0"}}}}},"SendOtpIntegration-Permission":{"id":"SendOtpIntegration-Permission","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--send-otp/SendOtpIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["SendOtpFnA6E032A5","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:",{"Ref":"AWS::Region"},":723609008675:",{"Ref":"ChatShyldHttpApiE87B938B"},"/*/*/auth/send-otp"]]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--send-otp/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"authorizationType":"NONE","routeKey":"POST /auth/send-otp","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatShyldHttpApiPOSTauthsendotpSendOtpIntegration5796B4DF"}]]}}}}}},"POST--auth--verify-otp":{"id":"POST--auth--verify-otp","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--verify-otp","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.211.0","metadata":["*"]},"children":{"VerifyOtpIntegration":{"id":"VerifyOtpIntegration","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--verify-otp/VerifyOtpIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--verify-otp/VerifyOtpIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["VerifyOtpFn7C64DA59","Arn"]},"payloadFormatVersion":"2.0"}}}}},"VerifyOtpIntegration-Permission":{"id":"VerifyOtpIntegration-Permission","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--verify-otp/VerifyOtpIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["VerifyOtpFn7C64DA59","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:",{"Ref":"AWS::Region"},":723609008675:",{"Ref":"ChatShyldHttpApiE87B938B"},"/*/*/auth/verify-otp"]]}}}},"Resource":{"id":"Resource","path":"ChatshyldStack/ChatShyldHttpApi/POST--auth--verify-otp/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"authorizationType":"NONE","routeKey":"POST /auth/verify-otp","target":{"Fn::Join":["",["integrations/",{"Ref":"ChatShyldHttpApiPOSTauthverifyotpVerifyOtpIntegration8BBC8DD9"}]]}}}}}}}},"ProdStage":{"id":"ProdStage","path":"ChatshyldStack/ProdStage","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpStage","version":"2.211.0","metadata":["*"]},"children":{"Resource":{"id":"Resource","path":"ChatshyldStack/ProdStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"apiId":{"Ref":"ChatShyldHttpApiE87B938B"},"autoDeploy":true,"defaultRouteSettings":{"throttlingBurstLimit":50,"throttlingRateLimit":25},"stageName":"prod"}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"ChatshyldStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ChatshyldStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}},"Condition":{"id":"Condition","path":"ChatshyldStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.211.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ChatshyldStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.211.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ChatshyldStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.211.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}